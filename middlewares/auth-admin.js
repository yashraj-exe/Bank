const jwt=require("jsonwebtoken"),bcrypt=require("bcrypt"),moment=require("moment"),verifyAdminToken=async(a,c,e)=>{let d=a.headers.authorization,b;if(""!=d)try{b=d;let f=jwt.verify(b,process.env.JWT_SECRET_KEY);await bcrypt.compare(moment(new Date).format("DD-MM-YYYY"),f.admin)?a.valid=!0:a.valid=!1,e()}catch(g){c.status(400).send({status:"FAILED",message:" unauthorize Admin"})}b||c.status(400).send({status:"FAILED",message:" unauthorize Admin, no token"})};module.exports=verifyAdminToken